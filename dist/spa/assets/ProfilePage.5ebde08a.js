import{p as Z,a1 as G,af as H,a2 as J,ag as W,c as g,ah as Y,g as ee,h as y,y as R,ai as te,v as ae,ad as se,d as Q,l as o,q as d,A as C,f as i,x as b,a5 as ne,a6 as oe,F as D,_ as U,r as k,m as F,a7 as ie,Q as I,z as le,X as j,aj as ce,ak as z,R as re,u as S,al as ue,Z as de}from"./index.737d3221.js";import{Q as fe}from"./QPage.7f3ad2a1.js";import{Q as ve}from"./QImg.fb96251b.js";import{Q as _e}from"./QToolbar.52cfa946.js";import{u as M,P as me,a as he}from"./PostsSkeleton.f832b1db.js";import{u as pe}from"./account-store.93e228d8.js";import{u as O}from"./friends-store.63435914.js";import"./auth-store.79001c12.js";import"./axios.37d53be1.js";import"./use-quasar.8362b04f.js";import"./dates.89413a91.js";const ge={xs:8,sm:10,md:14,lg:20,xl:24};var L=Z({name:"QChip",props:{...G,...H,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:s,emit:a}){const{proxy:{$q:r}}=ee(),f=J(e,r),h=W(e,ge),p=g(()=>e.selected===!0||e.icon!==void 0),q=g(()=>e.selected===!0?e.iconSelected||r.iconSet.chip.selected:e.icon),T=g(()=>e.iconRemove||r.iconSet.chip.remove),u=g(()=>e.disable===!1&&(e.clickable===!0||e.selected!==null)),w=g(()=>{const t=e.outline===!0&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(e.outline===!1&&e.color!==void 0?` bg-${e.color}`:"")+(t?` text-${t} q-chip--colored`:"")+(e.disable===!0?" disabled":"")+(e.dense===!0?" q-chip--dense":"")+(e.outline===!0?" q-chip--outline":"")+(e.selected===!0?" q-chip--selected":"")+(u.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(e.square===!0?" q-chip--square":"")+(f.value===!0?" q-chip--dark q-dark":"")}),P=g(()=>{const t=e.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0},m={...t,role:"button","aria-hidden":"false","aria-label":e.removeAriaLabel||r.lang.label.remove};return{chip:t,remove:m}});function _(t){t.keyCode===13&&v(t)}function v(t){e.disable||(a("update:selected",!e.selected),a("click",t))}function c(t){(t.keyCode===void 0||t.keyCode===13)&&(se(t),e.disable===!1&&(a("update:modelValue",!1),a("remove")))}function n(){const t=[];u.value===!0&&t.push(y("div",{class:"q-focus-helper"})),p.value===!0&&t.push(y(R,{class:"q-chip__icon q-chip__icon--left",name:q.value}));const m=e.label!==void 0?[y("div",{class:"ellipsis"},[e.label])]:void 0;return t.push(y("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},te(s.default,m))),e.iconRight&&t.push(y(R,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),e.removable===!0&&t.push(y(R,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:T.value,...P.value.remove,onClick:c,onKeyup:c})),t}return()=>{if(e.modelValue===!1)return;const t={class:w.value,style:h.value};return u.value===!0&&Object.assign(t,P.value.chip,{onClick:v,onKeyup:_}),Y("div",t,n(),"ripple",e.ripple!==!1&&e.disable!==!0,()=>[[ae,e.ripple]])}}});const ye={class:"profile-div"},be=["src"],qe={class:"row justify-center"},Se=Q({__name:"ProfileThumbnail",props:["coverUrl","avatarUrl","name"],setup(e){return(s,a)=>(o(),d(D,null,[C("div",ye,[i(ve,{width:"800px",height:"200px",fit:"cover",class:"profile-thumbnail rounded-borders col-6 q-ma-sm",src:e.coverUrl},null,8,["src"]),i(ne,{size:"128px",class:"profile-avatar"},{default:b(()=>[C("img",{src:e.avatarUrl,alt:""},null,8,be)]),_:1})]),C("h3",qe,oe(e.name),1)],64))}});var xe=U(Se,[["__scopeId","data-v-51ae2cb0"]]);const ke={__name:"ProfileInput",setup(e){const{createPost:s}=M(),a=k(""),r=async()=>{try{await s(a.value),a.value=""}catch(f){console.log(f)}};return(f,h)=>(o(),F(_e,{class:"justify-center"},{default:b(()=>[i(ie,{rounded:"",outlined:"",modelValue:a.value,"onUpdate:modelValue":h[0]||(h[0]=p=>a.value=p),class:"input",autogrow:"",label:"post here",type:"textarea"},null,8,["modelValue"]),i(I,{onClick:r},{default:b(()=>[le("Post")]),_:1})]),_:1}))}};var Pe=U(ke,[["__scopeId","data-v-3b219545"]]);const we={key:0},Re={key:0,class:"row justify-center q-ma-md"},Ce={key:1,class:"row justify-center q-ma-md"},Fe={key:2,class:"row justify-center q-ma-md"},Ie={key:3,class:"row justify-center q-ma-md"},Ae={key:0,class:"row justify-center"},Be={key:1},Qe={key:1,class:"row justify-center"},{getFriendsData:Ue}=O(),E=pe(),{getMyAccount:je,getAccount:Te}=E,{currentAccount:x}=j(E),K=M(),{getPosts:Ve,getUserPosts:ze}=K,{posts:X}=j(K),A=k(!1),l={isFriend:!1,isPendingAccept:!1,isRequestSent:!1};function Le(e,s){l.isFriend=!1,l.isPendingAccept=!1,l.isRequestSent=!1,s.friendsList.includes(e)?l.isFriend=!0:s.receivedRequests.includes(e)?l.isPendingAccept=!0:s.sentRequests.includes(e)&&(l.isRequestSent=!0)}async function N(e,s){try{z.show();const a=e.params.id,r=await Ue();Le(a,r.friendsData),a?(x.value=await Te(a),await ze(a),A.value=!1):(await je(),await Ve(),A.value=!0),$e()}catch(a){return console.log(a),{name:re.profileNotFound}}finally{z.hide()}}const Ne=Q({async beforeRouteEnter(e,s){return await N(e)},async beforeRouteUpdate(e,s){return await N(e)}}),B=k(!1),$=g(()=>X.value.slice().reverse());function $e(){B.value=!1,setTimeout(()=>{B.value=!0},1e3)}const De=Q({...Ne,__name:"ProfilePage",setup(e){const s=O(),{sendFriendRequest:a,acceptFriendRequest:r}=s,{friendsData:f,potentialFriends:h}=j(s),p=k(!1),q=k(!1),u=ce().params.id;async function w(){var _,v,c;try{p.value=!0;const n=await a(u),t=(_=h.value)==null?void 0:_.findIndex(m=>m.toString()===u);t!=-1&&t!=null&&((v=h.value)==null||v.splice(t,1),(c=f.value)==null||c.sentRequests.push(u))}catch(n){console.log(n)}finally{p.value=!1,l.isRequestSent=!0}}async function P(){var _,v,c;try{q.value=!0,await r(u);const n=(_=f.value)==null?void 0:_.receivedRequests.findIndex(t=>t.toString()===u);n!=-1&&n!=null&&((v=f.value)==null||v.receivedRequests.splice(n,1),(c=f.value)==null||c.friendsList.push(u))}catch(n){console.log(n)}finally{q.value=!1,l.isPendingAccept=!1,l.isFriend=!0}}return(_,v)=>(o(),F(fe,{padding:"",class:"page"},{default:b(()=>[i(de,{class:"profile-card"},{default:b(()=>{var c,n,t;return[i(xe,{coverUrl:(c=S(x))==null?void 0:c.coverUrl,avatarUrl:(n=S(x))==null?void 0:n.avatarUrl,name:(t=S(x))==null?void 0:t.name},null,8,["coverUrl","avatarUrl","name"]),A.value?(o(),d("div",we,[i(Pe)])):(o(),d(D,{key:1},[l.isFriend?(o(),d("div",Re,[i(L,{square:"","text-color":"white",size:"16px",color:"primary",icon:"how_to_reg",label:"Friends","no-caps":""})])):l.isPendingAccept?(o(),d("div",Ce,[i(I,{onClick:P,loading:q.value,icon:"person_add",label:"Accept Friend","no-caps":""},null,8,["loading"])])):l.isRequestSent?(o(),d("div",Fe,[i(L,{square:"","text-color":"white",size:"16px",color:"primary",icon:"done",label:"Friend Request Sent","no-caps":""})])):(o(),d("div",Ie,[i(I,{onClick:w,loading:p.value,icon:"person_add",label:"Add Friend","no-caps":""},null,8,["loading"])]))],64)),i(ue,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:b(()=>{var m,V;return[B.value?(o(),d("div",Ae,[$.value.length!=0?(o(),F(me,{key:0,posts:$.value,accountsMap:{[(V=(m=S(X))==null?void 0:m[0])==null?void 0:V.createdBy.toString()]:S(x)}},null,8,["posts","accountsMap"])):(o(),d("h5",Be,"No Posts To Show"))])):(o(),d("div",Qe,[i(he)]))]}),_:1})]}),_:1})]),_:1}))}});var et=U(De,[["__scopeId","data-v-7337e820"]]);export{et as default};
